# Golang 指针与地址学习笔记

## 1. 基本概念

### 1.1 什么是地址？
- **地址** 是指在内存中存储数据的具体位置。每个变量在内存中都有一个唯一的地址，用于标识它所占用的内存空间。通过访问地址，可以直接操作存储在该地址上的数据。
- 在Golang中，使用 `&` 符号可以获取一个变量的地址。

  ```go
  var a int = 10
  fmt.Println(&a) // 输出变量a的内存地址
  ```

### 1.2 什么是指针？
- **指针** 是一种保存变量地址的变量。通过指针可以间接地访问或修改存储在某个地址上的数据。
- 指针的类型由它指向的变量类型决定。比如，一个指向 `int` 类型变量的指针，其类型是 `*int`。
- 在Golang中，使用 `*` 符号可以声明指针类型，也可以通过指针变量访问该指针指向的变量值。

  ```go
  var a int = 10
  var p *int = &a // 声明一个指向a的指针p

  fmt.Println(p)  // 输出p指针的值，即a的内存地址
  fmt.Println(*p) // 输出p指针指向的变量的值，即a的值10
  ```

### 1.3 指针的零值
- 在Golang中，指针的零值是 `nil`，表示该指针尚未指向任何变量或内存地址。

  ```go
  var p *int
  fmt.Println(p) // 输出 nil
  ```

## 2. Golang 中的 `new` 和 `make`

### 2.1 `new` 函数
- `new` 是一个内置函数，用于为基础类型（如 `int`、`string`、`struct` 等）分配内存空间，并返回指向该类型的指针。
- `new` 创建的变量是零值初始化的，并且返回的总是一个指向该类型的指针。

  ```go
  var p *int = new(int) // 创建一个指向int类型的指针，p指向的值为0
  fmt.Println(*p)      // 输出0
  ```

### 2.2 `make` 函数
- `make` 是一个内置函数，专门用于创建 `slice`、`map` 和 `channel` 等引用类型（reference type）的变量。
- 与 `new` 不同，`make` 返回的不是指针，而是具体的类型本身。创建的 `slice`、`map` 和 `channel` 已经初始化过，可以直接使用。

  ```go
  s := make([]int, 5) // 创建一个长度为5的int类型slice
  fmt.Println(s)      // 输出 [0 0 0 0 0]

  m := make(map[string]int) // 创建一个空的map
  m["age"] = 30
  fmt.Println(m)            // 输出 map[age:30]
  ```

### 提醒：关于 `string` 类型
- 在Golang中，`string` 是一种内建的复杂数据类型，不同于 `int`、`float` 等基本数据类型。
- 尽管 `string` 使用了指针来引用底层字节数组，但它是不可变的，且表现出值类型的行为。
- 传递 `string` 时，采用的是值传递，`string` 的零值是空字符串 `""`。

## 3. 指针的操作与应用场景

### 3.1 指针的应用场景
- **引用传递**：当你希望函数内部的修改能影响到函数外部的变量时，可以使用指针来传递参数，从而实现对原变量的直接修改。

  ```go
  func modify(p *int) {
      *p = 20
  }

  func main() {
      a := 10
      modify(&a)
      fmt.Println(a) // 输出20，说明a的值被函数内部修改了
  }
  ```

- **动态数据结构**：例如链表、树等结构中，指针用于连接不同节点，从而构建复杂的数据结构。

### 3.2 指针的注意事项
- **避免空指针错误**：在使用指针之前，确保它已经被正确初始化，避免对 `nil` 指针进行解引用操作，这会导致运行时错误。
- **内存管理**：Golang有垃圾回收机制，但仍需注意避免因不当的指针操作导致的内存泄漏或悬挂指针（dangling pointer）。

## 4. 总结
- **地址**：表示变量在内存中的存储位置。
- **指针**：保存变量地址的变量，可以通过指针间接操作内存中的数据。
- **`new`**：为基础类型分配内存并返回指向该内存的指针。
- **`make`**：用于创建并初始化 `slice`、`map` 和 `channel` 等引用类型。
- **`string` 提醒**：`string` 是一种内建的复杂数据类型，不同于基本类型，传递时采用值语义。
